import{V as H,r as D}from"./VForm-e39ec092.js";import{d as me,r as n,j as pe,i as fe,d3 as N,a4 as Ve,w as J,o as R,f as _e,e as a,b as e,t as u,m as s,b8 as f,bd as ve,n as r,_ as W,c as X,h as be,F as he,ah as h,aQ as xe,v as y}from"./index-a53a8952.js";import{_ as De}from"./AppCombobox.vue_vue_type_script_setup_true_lang-66d45357.js";import{_ as ye}from"./AppTextField.vue_vue_type_script_setup_true_lang-67d5d1b2.js";import{_ as Ce}from"./AppTextarea.vue_vue_type_script_setup_true_lang-4eab91a7.js";import{_ as we}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-562b0308.js";import{$ as x}from"./api-ec3e724e.js";import{b as G,a as Te,V as L,c as ke}from"./VCard-d127a45c.js";import{V as S,a as V}from"./VRow-c94e7ca1.js";import{V as A}from"./VCardText-aee0dbdb.js";import{V as ge}from"./VTable-fc36ca22.js";import{V as Y}from"./VDialog-8b105375.js";import{V as E}from"./VSpacer-89a56116.js";import{V as $e}from"./VChip-20150644.js";import"./VInput-3bdfe183.js";import"./VImg-474ef2cf.js";import"./forwardRefs-6ea3df5c.js";import"./filter-1397fd47.js";import"./VTextField-697652b6.js";import"./VField-d18a24a0.js";import"./VList-ec352a59.js";import"./VAvatar-f404fd96.js";import"./VDivider-b3da116a.js";import"./VOverlay-8ecede3e.js";import"./lazy-774a69d6.js";import"./VMenu-c6ad9173.js";import"./VCheckboxBtn-61140018.js";import"./VSelectionControl-5641c132.js";const Be=r("th",{class:"text-center"}," id ",-1),qe=r("th",{class:"text-center"}," Giá trị đơn giá ",-1),Ue=r("th",{class:"text-center"}," Loại xe ",-1),Fe=r("th",{class:"text-center"}," Tuyến ",-1),Ie=r("th",{class:"text-center"}," Trạng thái ",-1),Ne={class:"text-center"},Re={class:"text-center"},Ge={class:"text-center"},Le={class:"text-center"},Se={class:"text-center"},Ae={class:"text-center"},Ee={class:"text-center"},Pe=r("span",{class:"text-h5"},"Thêm chi tiết",-1),ht=me({__name:"[id]",async setup(ze){let c,_;const $=n(!1),P=n(),B=n(!1),C=n(),z=n([]),O=n([]),Z=pe(),w=n(),T=n(),k=n(),ee=[{value:1,title:"Ghế"},{value:2,title:"Giường"},{value:3,title:"Limousine"}],te=fe(),ae=([c,_]=N(()=>x("api/price/get",{method:"GET",params:{priceId:te.params.id}})),c=await c,_(),c),d=Ve(()=>ae.data.valueReponse.data),m=new Date(d.value.fromDate)<new Date,p=d.value.status===0,v=n(!1),b=n(!1);let j=-1;function le(l){j=l,b.value=!0}function oe(){re(j),U()}function q(){v.value=!1}function U(){b.value=!1}J(v,l=>{l||q()}),J(b,l=>{l||U()});async function se(){const t=(await x("api/route/find-all",{method:"GET"})).data.valueReponse.data;O.value=t.map(i=>({value:i.id,title:`${i.from.fullName} - ${i.to.fullName}`}))}[c,_]=N(()=>se()),await c,_();async function F(){const t=(await x("api/price/find-detail",{method:"GET",params:{priceId:d.value.id}})).data.valueReponse.data;z.value=t.map(i=>({id:i.id,priceDetailCode:i.detailCode,priceValue:i.value,status:i.status,typeBus:i.typeBus.name,route:`${i.route.from.fullName} - ${i.route.to.fullName}`}))}[c,_]=N(()=>F()),await c,_();async function ie(){await x("api/price/create-detail",{method:"POST",data:{typeBusId:T.value.value,routeId:w.value.value,priceValue:k.value,priceId:d.value.id}}),await F()}async function re(l){await x(`api/price/delete-price-detail/${l}`,{method:"DELETE"}),await F()}function de(){var l;(l=C.value)==null||l.validate().then(({valid:t})=>{t&&(ie(),location.reload(),q(),xe(()=>{var i,g;(i=C.value)==null||i.reset(),(g=C.value)==null||g.resetValidation()}))})}async function ne(){const t=(await x("api/price/update",{method:"POST",data:{priceDescription:d.value.description,fromDate:d.value.fromDate,toDate:d.value.toDate,priceId:d.value.id}})).data;console.log(t.respType==="200"),t.respType===200&&Z.replace("/price/list")}function ue(){var l;(l=P.value)==null||l.validate().then(({valid:t})=>{t&&ne()})}const K=l=>{const t=l;if(t===1)return{color:"success",value:"active"};if(t===0)return{color:"secondary",value:"inactive"}};return(l,t)=>{const i=we,g=Ce,ce=ye,M=De;return R(),_e(L,{class:"pa-sm-8 pa-5"},{default:a(()=>[e(Te,{class:"text-center"},{default:a(()=>[e(G,{class:"text-h3 mb-3"},{default:a(()=>[u(" Cập nhật đơn giá ")]),_:1})]),_:1}),e(A,null,{default:a(()=>[e(s(H),{ref_key:"refForm",ref:P,modelValue:s($),"onUpdate:modelValue":t[4]||(t[4]=o=>f($)?$.value=o:null),onSubmit:ve(ue,["prevent"])},{default:a(()=>[e(S,null,{default:a(()=>[e(V,{cols:"12",md:"6"},{default:a(()=>[e(i,{modelValue:s(d).fromDate,"onUpdate:modelValue":t[0]||(t[0]=o=>s(d).fromDate=o),disabled:m||p,rules:["requiredValidator"in l?l.requiredValidator:s(D)],label:"Ngày có hiệu lực"},null,8,["modelValue","disabled","rules"])]),_:1}),e(V,{cols:"12",md:"6"},{default:a(()=>[e(i,{modelValue:s(d).toDate,"onUpdate:modelValue":t[1]||(t[1]=o=>s(d).toDate=o),disabled:m||p,rules:["requiredValidator"in l?l.requiredValidator:s(D)],label:"Ngày hết hiệu lực"},null,8,["modelValue","disabled","rules"])]),_:1}),e(V,{cols:"12",md:"12"},{default:a(()=>[e(g,{modelValue:s(d).description,"onUpdate:modelValue":t[2]||(t[2]=o=>s(d).description=o),disabled:m||p,rows:"2",label:"Ghi chú"},null,8,["modelValue","disabled"])]),_:1}),e(A,null,{default:a(()=>[e(ge,null,{default:a(()=>[r("thead",null,[r("tr",null,[Be,qe,Ue,Fe,Ie,r("th",Ne,[e(W,{class:"me-2",size:"small",icon:"tabler-plus",onClick:t[3]||(t[3]=o=>v.value=!0)})])])]),r("tbody",null,[(R(!0),X(he,null,be(s(z),o=>{var Q;return R(),X("tr",{key:o.id},[r("td",Re,y(o.id),1),r("td",Ge,y(o.priceValue),1),r("td",Le,y(o.typeBus),1),r("td",Se,y(o.route),1),r("td",Ae,[e($e,{color:(Q=K(o.status))==null?void 0:Q.color,size:"small",label:"",class:"text-capitalize"},{default:a(()=>{var I;return[u(y((I=K(o.status))==null?void 0:I.value),1)]}),_:2},1032,["color"])]),r("td",Ee,[e(W,{size:"small",icon:"tabler-trash",onClick:I=>le(o.id)},null,8,["onClick"])])])}),128))])]),_:1})]),_:1}),e(V,{cols:"12",class:"d-flex flex-wrap justify-center gap-4"},{default:a(()=>[e(h,{type:"submit",class:"me-3",disabled:m||p},{default:a(()=>[u(" Cập nhật ")]),_:1},8,["disabled"]),e(h,{type:"reset",variant:"outlined",color:"secondary",to:"/price/list"},{default:a(()=>[u(" Trở lại ")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{modelValue:s(v),"onUpdate:modelValue":t[9]||(t[9]=o=>f(v)?v.value=o:null),"max-width":"500px"},{default:a(()=>[e(L,null,{default:a(()=>[e(G,null,{default:a(()=>[Pe]),_:1}),e(A,null,{default:a(()=>[e(s(H),{ref_key:"refFormDetail",ref:C,modelValue:s(B),"onUpdate:modelValue":t[8]||(t[8]=o=>f(B)?B.value=o:null)},{default:a(()=>[e(S,null,{default:a(()=>[e(V,{cols:"12",md:"6",mb:"12"},{default:a(()=>[e(ce,{modelValue:s(k),"onUpdate:modelValue":t[5]||(t[5]=o=>f(k)?k.value=o:null),label:"Giá trị đơn giá",disabled:m||p,rules:["requiredValidator"in l?l.requiredValidator:s(D)]},null,8,["modelValue","disabled","rules"])]),_:1}),e(V,{cols:"12",md:"6",mb:"12"},{default:a(()=>[e(M,{modelValue:s(w),"onUpdate:modelValue":t[6]||(t[6]=o=>f(w)?w.value=o:null),items:s(O),disabled:m||p,label:"Chuyến xe",rules:["requiredValidator"in l?l.requiredValidator:s(D)]},null,8,["modelValue","items","disabled","rules"])]),_:1}),e(V,{cols:"12",md:"6",mb:"12"},{default:a(()=>[e(M,{modelValue:s(T),"onUpdate:modelValue":t[7]||(t[7]=o=>f(T)?T.value=o:null),items:ee,disabled:m||p,label:"Loại xe",rules:["requiredValidator"in l?l.requiredValidator:s(D)]},null,8,["modelValue","disabled","rules"])]),_:1})]),_:1}),e(S,null,{default:a(()=>[e(E),e(h,{color:"blue-darken-1",variant:"text",onClick:q},{default:a(()=>[u(" Thoát ")]),_:1}),e(h,{color:"blue-darken-1",variant:"text",type:"submit",disabled:m||p,onClick:de},{default:a(()=>[u(" Lưu chi tiết ")]),_:1},8,["disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(Y,{modelValue:s(b),"onUpdate:modelValue":t[10]||(t[10]=o=>f(b)?b.value=o:null),"max-width":"500px"},{default:a(()=>[e(L,null,{default:a(()=>[e(G,{class:"text-h5"},{default:a(()=>[u(" Bạn có muốn xoá chi tiết đơn giá này không? ")]),_:1}),e(ke,null,{default:a(()=>[e(E),e(h,{color:"blue-darken-1",variant:"text",onClick:U},{default:a(()=>[u(" Cancel ")]),_:1}),e(h,{color:"blue-darken-1",variant:"text",onClick:oe},{default:a(()=>[u(" OK ")]),_:1}),e(E)]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}});export{ht as default};
