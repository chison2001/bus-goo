const C=/#/g,A=/&/g,g=/=/g,h=/\+/g,P=/%5e/gi,O=/%60/gi,d=/%7c/gi,L=/%20/gi;function Q(t){return encodeURI(""+t).replace(d,"|")}function a(t){return Q(typeof t=="string"?t:JSON.stringify(t)).replace(h,"%2B").replace(L,"+").replace(C,"%23").replace(A,"%26").replace(O,"`").replace(P,"^")}function s(t){return a(t).replace(g,"%3D")}function p(t=""){try{return decodeURIComponent(""+t)}catch{return""+t}}function b(t){return p(t.replace(h," "))}function T(t){return p(t.replace(h," "))}function w(t=""){const e={};t[0]==="?"&&(t=t.slice(1));for(const o of t.split("&")){const n=o.match(/([^=]+)=?(.*)/)||[];if(n.length<2)continue;const c=b(n[1]);if(c==="__proto__"||c==="constructor")continue;const r=T(n[2]||"");e[c]===void 0?e[c]=r:Array.isArray(e[c])?e[c].push(r):e[c]=[e[c],r]}return e}function I(t,e){return(typeof e=="number"||typeof e=="boolean")&&(e=String(e)),e?Array.isArray(e)?e.map(o=>`${s(t)}=${a(o)}`).join("&"):`${s(t)}=${a(e)}`:s(t)}function N(t){return Object.keys(t).filter(e=>t[e]!==void 0).map(e=>I(e,t[e])).filter(Boolean).join("&")}const U=/^[\s\w\0+.-]{2,}:([/\\]{1,2})/,j=/^[\s\w\0+.-]{2,}:([/\\]{2})?/,K=/^([/\\]\s*){2,}[^/\\]/;function $(t,e={}){return typeof e=="boolean"&&(e={acceptRelative:e}),e.strict?U.test(t):j.test(t)||(e.acceptRelative?K.test(t):!1)}function G(t,e){const o=E(t),n={...w(o.search),...e};return o.search=N(n),B(o)}function E(t="",e){const o=t.match(/^[\s\0]*(blob:|data:|javascript:|vbscript:)(.*)/i);if(o){const[,u,f=""]=o;return{protocol:u.toLowerCase(),pathname:f,href:u+f,auth:"",host:"",search:"",hash:""}}if(!$(t,{acceptRelative:!0}))return e?E(e+t):l(t);const[,n="",c,r=""]=t.replace(/\\/g,"/").match(/^[\s\0]*([\w+.-]{2,}:)?\/\/([^/@]+@)?(.*)/)||[],[,i="",R=""]=r.match(/([^#/?]*)(.*)?/)||[],{pathname:_,search:y,hash:m}=l(R.replace(/\/(?=[A-Za-z]:)/,""));return{protocol:n.toLowerCase(),auth:c?c.slice(0,Math.max(0,c.length-1)):"",host:i,pathname:_,search:y,hash:m}}function l(t=""){const[e="",o="",n=""]=(t.match(/([^#?]*)(\?[^#]*)?(#.*)?/)||[]).splice(1);return{pathname:e,search:o,hash:n}}function B(t){const e=t.pathname||"",o=t.search?(t.search.startsWith("?")?"":"?")+t.search:"",n=t.hash||"",c=t.auth?t.auth+"@":"",r=t.host||"";return(t.protocol?t.protocol+"//":"")+c+r+e+o+n}export{N as s,G as w};
